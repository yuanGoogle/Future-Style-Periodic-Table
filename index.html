<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Êú™Êù•È£éÂÖÉÁ¥†Âë®ÊúüË°®</title>
    <style>
        :root {
            --bg-dark: #050505;
            --card-bg: rgba(255, 255, 255, 0.03);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-main: #e0e0e0;
            --accent-cyan: #00f3ff;
            --accent-pink: #ff00aa;
            --valence-color: #ff0055;
            --inner-color: #00a8ff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', 'PingFang SC', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: 
                radial-gradient(circle at 50% 50%, rgba(20, 30, 50, 0.5) 0%, transparent 50%),
                linear-gradient(0deg, rgba(0,243,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,243,255,0.03) 1px, transparent 1px);
            background-size: 100% 100%, 40px 40px, 40px 40px;
        }

        /* === ÂØºËà™Ê†èÂå∫Âüü‰ºòÂåñ === */
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            background: rgba(20, 20, 25, 0.95);
            backdrop-filter: blur(10px);
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            margin-bottom: 15px;
            z-index: 100;
            width: 100%;
            justify-content: center;
            align-items: center;
            position: sticky;
            top: 0;
        }

        .title-box h1 {
            font-size: 20px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(90deg, #fff, var(--accent-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            white-space: nowrap;
        }

        .mode-group {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 4px;
            gap: 4px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .mode-btn {
            background: transparent;
            border: 1px solid transparent;
            color: #aaa;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            transition: 0.3s;
            font-weight: 500;
            white-space: nowrap;
        }

        .mode-btn:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .mode-btn.active {
            background: var(--accent-cyan);
            color: #000;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.4);
        }

        .search-box {
            width: 100%;
            max-width: 280px;
        }

        .search-box input {
            background: rgba(0,0,0,0.3);
            border: 1px solid #444;
            color: #fff;
            padding: 10px 15px;
            border-radius: 8px;
            outline: none;
            width: 100%;
            font-size: 14px;
        }

        /* === Âë®ÊúüË°®ÂÆπÂô® === */
        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 10px;
            -webkit-overflow-scrolling: touch;
        }

        .periodic-table {
            display: grid;
            grid-template-columns: repeat(18, 68px);
            grid-template-rows: repeat(10, 76px);
            gap: 5px;
            margin: 0 auto 30px;
            transition: 0.5s;
            width: max-content;
        }

        .element {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2px;
            opacity: 0;
            transform: scale(0.8);
        }

        .element.visible { opacity: 1; transform: scale(1); }
        
        .element:hover {
            transform: scale(1.15) !important;
            z-index: 100;
            box-shadow: 0 0 25px rgba(0,0,0,0.8);
            border-color: #fff;
        }

        .element .atomic-number { 
            position: absolute; 
            top: 4px; 
            left: 5px; 
            font-size: 10px;
            opacity: 0.6; 
        }
        
        .element .symbol { 
            font-size: 24px;
            font-weight: 700; 
            text-shadow: 0 1px 3px rgba(0,0,0,0.5); 
            line-height: 1.1;
            margin-top: 4px;
            font-family: Arial, sans-serif;
        }
        
        .element .name { 
            font-size: 11px; 
            opacity: 0.95; 
            margin-top: 0px; 
            font-weight: 500;
        }

        .element .detail-val { 
            position: absolute; bottom: 3px; right: 5px; 
            font-size: 9px;
            color: var(--accent-cyan); 
            display: none; 
            font-weight: bold;
        }

        .element.placeholder {
            border-style: dashed;
            background: rgba(255, 255, 255, 0.01);
            justify-content: center;
            align-items: center;
            gap: 2px;
        }
        .element.placeholder .range-num {
            font-size: 11px;
            color: var(--accent-cyan);
            font-weight: bold;
        }
        .element.placeholder .name {
            font-size: 11px;
            opacity: 0.8;
            margin: 0;
        }
        .element.placeholder:hover {
            background: rgba(255, 255, 255, 0.08);
            border-style: solid;
            transform: scale(1.05) !important; 
        }

        .periodic-table.heatmap-active .element {
            border-color: rgba(0,0,0,0.2);
        }
        .periodic-table.heatmap-active .element .detail-val { display: block; }

        /* === Âõæ‰æãÂå∫Âüü‰ºòÂåñ === */
        .legend-wrapper {
            width: 100%;
            padding: 0 10px;
            margin-bottom: 15px;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            max-width: 1000px;
            margin: 0 auto;
        }
        .legend-item {
            font-size: 12px;
            display: flex;
            align-items: center;
            padding: 6px 10px;
            border-radius: 15px;
            background: rgba(255,255,255,0.05);
            cursor: pointer;
            border: 1px solid transparent;
            transition: 0.3s;
        }
        .legend-item:hover { background: rgba(255,255,255,0.1); }
        .legend-item.active {
            background: rgba(255,255,255,0.2);
            border-color: var(--accent-cyan);
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.2);
        }

        .legend-color { width: 10px; height: 10px; border-radius: 3px; margin-right: 6px; flex-shrink: 0; }

        /* === ÂºπÁ™óÊ†∑Âºè === */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
            padding: 10px;
        }
        .modal-overlay.open { opacity: 1; pointer-events: all; }

        .hologram-card {
            width: 100%;
            max-width: 1000px;
            max-height: 90vh;
            background: linear-gradient(135deg, #1a1a20, #0a0a10);
            border: 1px solid rgba(0, 243, 255, 0.2);
            box-shadow: 0 0 60px rgba(0, 243, 255, 0.1);
            border-radius: 16px;
            display: flex;
            overflow: hidden;
            position: relative;
        }

        /* ‰ºòÂåñÂêéÁöÑÂÖ≥Èó≠ÊåâÈíÆ */
        .close-btn {
            position: absolute; 
            top: 15px; 
            right: 15px; 
            font-size: 24px;
            color: #fff; 
            cursor: pointer; 
            z-index: 2000; /* ÊèêÈ´òÂ±ÇÁ∫ß */
            width: 36px; 
            height: 36px;
            background: rgba(0, 0, 0, 0.6); /* Â¢ûÂä†ÂçäÈÄèÊòéÈªëÂ∫ïÔºåÈò≤Ê≠¢Áúã‰∏çÊ∏Ö */
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.2s;
        }
        .close-btn:hover { 
            background: rgba(255, 0, 0, 0.8);
            transform: rotate(90deg);
        }

        .atom-visualizer {
            width: 35%;
            min-width: 280px;
            background: radial-gradient(circle at center, rgba(0,243,255,0.05), transparent 70%);
            display: flex; 
            justify-content: center; 
            align-items: center;
            perspective: 800px;
            border-right: 1px solid rgba(255,255,255,0.05);
            position: relative;
            cursor: grab;
            user-select: none;
        }
        
        .atom-visualizer:active { cursor: grabbing; }

        .visualizer-hint {
            position: absolute;
            bottom: 15px;
            color: rgba(255,255,255,0.4);
            font-size: 12px;
            pointer-events: none;
        }

        .atom-container {
            width: 220px; height: 220px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s linear; 
        }

        .nucleus {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
            width: 12px; height: 12px; background: #fff; border-radius: 50%;
            box-shadow: 0 0 20px #fff; z-index: 20;
            transform-style: preserve-3d;
        }

        .orbit-ring {
            position: absolute; top: 50%; left: 50%;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.15);
            transform-style: preserve-3d;
        }

        .electron {
            position: absolute; top: 50%; left: 50%;
            border-radius: 50%;
            transform-origin: 0 0;
        }

        .electron.inner {
            width: 5px; height: 5px;
            background: var(--inner-color);
            box-shadow: 0 0 5px var(--inner-color);
        }

        .electron.valence {
            width: 8px; height: 8px;
            background: var(--valence-color);
            box-shadow: 0 0 12px var(--valence-color);
            z-index: 10;
        }

        .info-panel { 
            flex: 1; 
            padding: 25px; 
            display: flex; 
            flex-direction: column; 
            overflow-y: auto; 
            min-width: 0;
        }
        
        .header-row { 
            display: flex; 
            align-items: baseline; 
            margin-bottom: 15px; 
            border-bottom: 1px solid rgba(255,255,255,0.1); 
            padding-bottom: 12px;
            flex-wrap: wrap;
            gap: 10px;
            padding-right: 30px; /* ÁïôÂá∫ÂÖ≥Èó≠ÊåâÈíÆÁ©∫Èó¥ */
        }
        .big-symbol { font-size: 48px; font-weight: 700; color: var(--accent-cyan); margin-right: 15px; line-height: 1; font-family: Arial;}
        .big-name { font-size: 24px; color: #fff; font-weight: bold; }
        .category-tag { 
            margin-left: auto; 
            padding: 5px 10px; 
            border: 1px solid #444; 
            border-radius: 6px; 
            font-size: 12px; 
            color: #aaa; 
            text-transform: uppercase; 
            white-space: nowrap;
        }

        .config-box {
            background: rgba(0, 243, 255, 0.05);
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            flex-shrink: 0; /* Èò≤Ê≠¢Ë¢´ÂéãÁº© */
        }
        .config-label { font-size: 12px; color: var(--accent-cyan); margin-bottom: 5px; display: block; font-weight: bold;}
        .config-text { 
            font-size: 14px; 
            color: #e0e0e0; 
            letter-spacing: 1px; 
            word-break: break-all; /* Âº∫Âà∂Êç¢Ë°å */
            white-space: normal;
            line-height: 1.5;
        }

        .info-section {
            margin-bottom: 20px;
            flex-shrink: 0;
        }
        .info-section h3 {
            font-size: 13px;
            color: var(--accent-cyan);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.2);
            padding-bottom: 5px;
        }

        .props-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 10px; 
        }
        .prop-item { 
            background: rgba(255,255,255,0.02);
            padding: 8px 10px;
            border-radius: 6px;
            border-left: 3px solid rgba(0, 243, 255, 0.3);
        }
        .prop-item label { font-size: 11px; color: #888; display: block; margin-bottom: 3px; }
        .prop-item span { font-size: 14px; color: #fff; font-weight: 500; }

        .valence-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .valence-tag {
            background: linear-gradient(135deg, rgba(255,0,85,0.2), rgba(255,0,170,0.1));
            border: 1px solid rgba(255,0,85,0.4);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 14px;
            color: #ff6699;
            font-weight: 600;
        }

        .isotope-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .isotope-tag {
            background: rgba(0, 168, 255, 0.1);
            border: 1px solid rgba(0, 168, 255, 0.3);
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            color: #66ccff;
        }
        .isotope-tag .mass-num {
            font-size: 9px;
            vertical-align: super;
        }
        .isotope-stable {
            background: rgba(0, 255, 136, 0.1);
            border-color: rgba(0, 255, 136, 0.3);
            color: #66ff99;
        }

        /* === ÁßªÂä®Á´ØÊ®™Â±èÊèêÁ§∫ === */
        .rotate-hint {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(0, 243, 255, 0.1);
            border-bottom: 1px solid var(--accent-cyan);
            padding: 8px 15px;
            text-align: center;
            font-size: 12px;
            color: var(--accent-cyan);
            z-index: 99;
        }

        /* === Âπ≥ÊùøÈÄÇÈÖç (600px - 900px) === */
        @media(max-width: 900px) {
            .hologram-card { 
                flex-direction: column; 
                max-height: 95vh; 
            }
            .atom-visualizer { 
                width: 100%; 
                min-width: auto; 
                height: 200px; 
                border-right: none; 
                border-bottom: 1px solid #333; 
                flex-shrink: 0;
            }
            .atom-container {
                width: 180px;
                height: 180px;
            }
            .props-grid { 
                grid-template-columns: repeat(2, 1fr); 
            }
            .info-panel {
                padding: 20px;
            }
            .big-symbol {
                font-size: 40px;
            }
            .big-name {
                font-size: 20px;
            }
        }

        /* === ÊâãÊú∫Á´ØÈÄÇÈÖç (Â∞è‰∫é600px) === */
        @media(max-width: 600px) {
            .rotate-hint {
                display: block;
            }

            .control-panel {
                padding: 10px;
                gap: 10px;
                flex-direction: column;
                align-items: stretch;
                margin-bottom: 10px;
            }

            .title-box {
                text-align: center;
            }

            .title-box h1 {
                font-size: 18px;
                letter-spacing: 1px;
            }

            .mode-group {
                justify-content: center;
                padding: 3px;
                gap: 3px;
            }

            .mode-btn {
                padding: 6px 8px;
                font-size: 11px;
            }

            .search-box {
                max-width: 100%;
            }

            .search-box input {
                padding: 12px 15px;
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
            }

            .table-wrapper {
                padding: 5px;
            }

            .periodic-table {
                grid-template-columns: repeat(18, 52px);
                grid-template-rows: repeat(10, 60px);
                gap: 3px;
            }

            .element .atomic-number {
                font-size: 8px;
                top: 2px;
                left: 3px;
            }

            .element .symbol {
                font-size: 18px;
                margin-top: 2px;
            }

            .element .name {
                font-size: 9px;
            }

            .element .detail-val {
                font-size: 7px;
                bottom: 2px;
                right: 3px;
            }

            .element.placeholder .range-num {
                font-size: 9px;
            }

            .element.placeholder .name {
                font-size: 9px;
            }

            .element:hover {
                transform: scale(1.1) !important;
            }

            .legend-wrapper {
                padding: 0 5px;
                margin-bottom: 10px;
            }

            .legend {
                gap: 5px;
            }

            .legend-item {
                font-size: 10px;
                padding: 5px 8px;
            }

            .legend-color {
                width: 8px;
                height: 8px;
                margin-right: 4px;
            }

            /* ÂºπÁ™óÁßªÂä®Á´ØÈáçÂ§ß‰ºòÂåñ */
            .modal-overlay {
                padding: 0;
                align-items: flex-end; /* Â∫ïÈÉ®ÂØπÈΩê */
            }

            .hologram-card {
                /* ‰ΩøÁî® 100dvh ÈÄÇÈÖçÂä®ÊÄÅÂú∞ÂùÄÊ†èÔºåÈò≤Ê≠¢‰∏ãÊñπÂÜÖÂÆπË¢´ÈÅÆÊå° */
                max-height: 100dvh; 
                height: 100dvh;
                border-radius: 16px 16px 0 0;
                flex-direction: column;
            }

            /* ÁßªÂä®Á´ØÂÖ≥Èó≠ÊåâÈíÆË∞ÉÊï¥‰ΩçÁΩÆ */
            .close-btn {
                top: 15px;
                right: 15px;
                width: 40px;
                height: 40px;
                background: rgba(0,0,0,0.8); /* Êõ¥ÈªëÁöÑËÉåÊôØ */
                box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            }

            .atom-visualizer {
                height: 180px;
                min-height: 180px;
                /* ÁïôÂá∫È°∂ÈÉ®ÂÆâÂÖ®Ë∑ùÁ¶ªÔºåÈò≤Ê≠¢ÂàòÊµ∑ÈÅÆÊå°Ê®°Âûã */
                padding-top: env(safe-area-inset-top); 
            }

            .atom-container {
                width: 150px;
                height: 150px;
            }

            .visualizer-hint {
                font-size: 11px;
                bottom: 10px;
            }

            .info-panel {
                padding: 15px 20px;
                flex: 1;
                overflow-y: auto;
                /* Â∫ïÈÉ®Â¢ûÂä†Â§ßÈáèÂÜÖËæπË∑ùÔºåÁ°Æ‰øùÂÜÖÂÆπ‰∏çË¢´ÂàáÊñ≠ */
                padding-bottom: 80px; 
                -webkit-overflow-scrolling: touch; /* Âπ≥ÊªëÊªöÂä® */
            }

            .header-row {
                margin-bottom: 12px;
                padding-bottom: 10px;
                gap: 8px;
                padding-right: 0;
            }

            .big-symbol {
                font-size: 36px;
                margin-right: 10px;
            }

            .big-name {
                font-size: 18px;
            }

            #m-en-name {
                font-size: 14px !important;
            }

            .category-tag {
                font-size: 10px;
                padding: 4px 8px;
                margin-left: 0;
            }

            /* ÁîµÂ≠êÊéíÂ∏É‰øÆÂ§ç */
            .config-box {
                padding: 10px 12px;
                margin-bottom: 15px;
                overflow-x: auto; /* ÂÖÅËÆ∏Ê®™ÂêëÊªöÂä®Èò≤Ê≠¢ÊíëÁ†¥ */
            }

            .config-label {
                font-size: 11px;
            }

            .config-text {
                font-size: 13px; /* Á®çÂæÆË∞ÉÂ§ß‰∏ÄÁÇπÁÇπ */
                line-height: 1.6;
            }

            #m-config-shell {
                font-size: 11px !important;
            }

            .info-section {
                margin-bottom: 15px;
            }

            .info-section h3 {
                font-size: 12px;
                margin-bottom: 8px;
            }

            .props-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }

            .prop-item {
                padding: 6px 8px;
            }

            .prop-item label {
                font-size: 10px;
            }

            .prop-item span {
                font-size: 13px;
            }

            .valence-tags {
                gap: 6px;
            }

            .valence-tag {
                font-size: 13px;
                padding: 3px 10px;
            }

            .isotope-tags {
                gap: 6px;
            }

            .isotope-tag {
                font-size: 11px;
                padding: 3px 8px;
            }
        }

        /* === Ë∂ÖÂ∞èÂ±èÂπï (Â∞è‰∫é400px) === */
        @media(max-width: 400px) {
            .periodic-table {
                grid-template-columns: repeat(18, 44px);
                grid-template-rows: repeat(10, 52px);
                gap: 2px;
            }

            .element .atomic-number {
                font-size: 7px;
            }

            .element .symbol {
                font-size: 15px;
            }

            .element .name {
                font-size: 8px;
            }

            .mode-btn {
                padding: 5px 6px;
                font-size: 10px;
            }

            .legend-item {
                font-size: 9px;
                padding: 4px 6px;
            }

            .props-grid {
                grid-template-columns: 1fr;
            }
        }

        /* === Ê®™Â±èÊ®°Âºè‰ºòÂåñ === */
        @media(max-height: 500px) and (orientation: landscape) {
            .rotate-hint {
                display: none;
            }

            .control-panel {
                padding: 8px 15px;
                flex-direction: row;
            }

            .hologram-card {
                flex-direction: row;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
            }

            .atom-visualizer {
                width: 35%;
                height: 100%;
                min-width: 200px;
            }

            .info-panel {
                padding: 15px;
            }

            .header-row {
                margin-bottom: 10px;
                padding-bottom: 8px;
            }

            .big-symbol {
                font-size: 32px;
            }

            .big-name {
                font-size: 16px;
            }

            .config-box {
                margin-bottom: 10px;
                padding: 8px 10px;
            }

            .info-section {
                margin-bottom: 10px;
            }

            .props-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }
        }
    </style>
</head>
<body>

    <div class="bg-animation"></div>

    <div class="rotate-hint">üí° Ê®™Â±èÊü•ÁúãÊïàÊûúÊõ¥‰Ω≥</div>

    <div class="control-panel">
        <div class="title-box">
            <h1>ÂÖÉÁ¥†Âë®ÊúüË°®</h1>
        </div>
        
        <div class="mode-group">
            <button class="mode-btn active" onclick="setMode('default')">Ê†áÂáÜ</button>
            <button class="mode-btn" onclick="setMode('radius')">ÂçäÂæÑ</button>
            <button class="mode-btn" onclick="setMode('en')">ÁîµË¥üÊÄß</button>
            <button class="mode-btn" onclick="setMode('ip')">ÁîµÁ¶ªËÉΩ</button>
            <button class="mode-btn" onclick="setMode('melt')">ÁÜîÁÇπ</button>
            <button class="mode-btn" onclick="setMode('boil')">Ê≤∏ÁÇπ</button>
        </div>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Êü•ÊâæÂÖÉÁ¥†...">
        </div>
    </div>

    <div class="legend-wrapper">
        <div class="legend" id="legend"></div>
    </div>

    <div class="table-wrapper">
        <div class="periodic-table" id="table"></div>
    </div>

    <div class="modal-overlay" id="modal">
        <div class="hologram-card">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div class="atom-visualizer" id="atomWrapper">
                <div class="atom-container" id="atomContainer"></div>
                <div class="visualizer-hint">ÊãñÊãΩÊóãËΩ¨ËßÜËßí</div>
            </div>
            <div class="info-panel">
                <div class="header-row">
                    <div class="big-symbol" id="m-symbol">Fe</div>
                    <div class="big-name"><span id="m-name">ÈìÅ</span> <span id="m-en-name" style="font-size:16px;color:#666; margin-left:8px;">Iron</span></div>
                    <div class="category-tag" id="m-cat">ËøáÊ∏°ÈáëÂ±û</div>
                </div>

                <div class="config-box">
                    <label class="config-label">ÁîµÂ≠êÊéíÂ∏É</label>
                    <div class="config-text" id="m-config-sub">1s¬≤ 2s¬≤ ...</div>
                    <div style="margin-top:6px; font-size:12px; color:#888" id="m-config-shell">ÊØèÂ±Ç: 2-8-14-2</div>
                </div>

                <div class="info-section">
                    <h3>Â∏∏ËßÅÂåñÂêà‰ª∑</h3>
                    <div class="valence-tags" id="m-valence"></div>
                </div>

                <div class="info-section">
                    <h3>Áâ©ÁêÜÊÄßË¥®</h3>
                    <div class="props-grid">
                        <div class="prop-item"><label>ÂéüÂ≠êÂ∫èÊï∞</label><span id="m-num">26</span></div>
                        <div class="prop-item"><label>Áõ∏ÂØπÂéüÂ≠êË¥®Èáè</label><span id="m-mass">55.845</span></div>
                        <div class="prop-item"><label>ÂéüÂ≠êÂçäÂæÑ (pm)</label><span id="m-radius">126</span></div>
                        <div class="prop-item"><label>ÁîµË¥üÊÄß</label><span id="m-en">1.83</span></div>
                        <div class="prop-item"><label>ÁîµÁ¶ªËÉΩ (kJ/mol)</label><span id="m-ip">762.5</span></div>
                        <div class="prop-item"><label>ÁÜîÁÇπ (K)</label><span id="m-melt">1811</span></div>
                        <div class="prop-item"><label>Ê≤∏ÁÇπ (K)</label><span id="m-boil">3134</span></div>
                    </div>
                </div>

                <div class="info-section">
                    <h3>Âêå‰ΩçÁ¥† (‚óè Á®≥ÂÆö)</h3>
                    <div class="isotope-tags" id="m-isotopes"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === JSONÊ†ºÂºèÂÖÉÁ¥†Êï∞ÊçÆ ===
        const elementsData = [
            {"z":1,"sym":"H","name":"Ê∞¢","enName":"Hydrogen","mass":1.008,"cat":5,"radius":53,"en":2.2,"ip":1312,"melt":14.01,"boil":20,"valence":["+1","-1"],"isotopes":[{"m":1,"s":true},{"m":2,"s":true},{"m":3,"s":false}]},
            {"z":2,"sym":"He","name":"Ê∞¶","enName":"Helium","mass":4.0026,"cat":7,"radius":31,"en":0,"ip":2372.3,"melt":0.95,"boil":4,"valence":["0"],"isotopes":[{"m":3,"s":true},{"m":4,"s":true}]},
            {"z":3,"sym":"Li","name":"ÈîÇ","enName":"Lithium","mass":6.94,"cat":0,"radius":167,"en":0.98,"ip":520.2,"melt":453.69,"boil":1603,"valence":["+1"],"isotopes":[{"m":6,"s":true},{"m":7,"s":true}]},
            {"z":4,"sym":"Be","name":"Èìç","enName":"Beryllium","mass":9.0122,"cat":1,"radius":112,"en":1.57,"ip":899.5,"melt":1560,"boil":2742,"valence":["+2"],"isotopes":[{"m":9,"s":true}]},
            {"z":5,"sym":"B","name":"Á°º","enName":"Boron","mass":10.81,"cat":4,"radius":87,"en":2.04,"ip":800.6,"melt":2349,"boil":4200,"valence":["+3"],"isotopes":[{"m":10,"s":true},{"m":11,"s":true}]},
            {"z":6,"sym":"C","name":"Á¢≥","enName":"Carbon","mass":12.011,"cat":5,"radius":67,"en":2.55,"ip":1086.5,"melt":4000,"boil":4098,"valence":["-4","+2","+4"],"isotopes":[{"m":12,"s":true},{"m":13,"s":true},{"m":14,"s":false}]},
            {"z":7,"sym":"N","name":"Ê∞Æ","enName":"Nitrogen","mass":14.007,"cat":5,"radius":56,"en":3.04,"ip":1402.3,"melt":63.15,"boil":77,"valence":["-3","+3","+5"],"isotopes":[{"m":14,"s":true},{"m":15,"s":true}]},
            {"z":8,"sym":"O","name":"Ê∞ß","enName":"Oxygen","mass":15.999,"cat":5,"radius":48,"en":3.44,"ip":1313.9,"melt":54.36,"boil":90,"valence":["-2","-1"],"isotopes":[{"m":16,"s":true},{"m":17,"s":true},{"m":18,"s":true}]},
            {"z":9,"sym":"F","name":"Ê∞ü","enName":"Fluorine","mass":18.998,"cat":6,"radius":42,"en":3.98,"ip":1681,"melt":53.53,"boil":85,"valence":["-1"],"isotopes":[{"m":19,"s":true}]},
            {"z":10,"sym":"Ne","name":"Ê∞ñ","enName":"Neon","mass":20.18,"cat":7,"radius":38,"en":0,"ip":2080.7,"melt":24.56,"boil":27,"valence":["0"],"isotopes":[{"m":20,"s":true},{"m":21,"s":true},{"m":22,"s":true}]},
            {"z":11,"sym":"Na","name":"Èí†","enName":"Sodium","mass":22.99,"cat":0,"radius":190,"en":0.93,"ip":495.8,"melt":370.87,"boil":1156,"valence":["+1"],"isotopes":[{"m":23,"s":true}]},
            {"z":12,"sym":"Mg","name":"ÈïÅ","enName":"Magnesium","mass":24.305,"cat":1,"radius":145,"en":1.31,"ip":737.7,"melt":923,"boil":1363,"valence":["+2"],"isotopes":[{"m":24,"s":true},{"m":25,"s":true},{"m":26,"s":true}]},
            {"z":13,"sym":"Al","name":"Èìù","enName":"Aluminium","mass":26.982,"cat":3,"radius":118,"en":1.61,"ip":577.5,"melt":933.47,"boil":2792,"valence":["+3"],"isotopes":[{"m":27,"s":true}]},
            {"z":14,"sym":"Si","name":"Á°Ö","enName":"Silicon","mass":28.085,"cat":4,"radius":111,"en":1.9,"ip":786.5,"melt":1687,"boil":3538,"valence":["-4","+4"],"isotopes":[{"m":28,"s":true},{"m":29,"s":true},{"m":30,"s":true}]},
            {"z":15,"sym":"P","name":"Á£∑","enName":"Phosphorus","mass":30.974,"cat":5,"radius":98,"en":2.19,"ip":1011.8,"melt":317.3,"boil":554,"valence":["-3","+3","+5"],"isotopes":[{"m":31,"s":true}]},
            {"z":16,"sym":"S","name":"Á°´","enName":"Sulfur","mass":32.06,"cat":5,"radius":87,"en":2.58,"ip":999.6,"melt":388.36,"boil":718,"valence":["-2","+4","+6"],"isotopes":[{"m":32,"s":true},{"m":33,"s":true},{"m":34,"s":true},{"m":36,"s":true}]},
            {"z":17,"sym":"Cl","name":"Ê∞Ø","enName":"Chlorine","mass":35.45,"cat":6,"radius":79,"en":3.16,"ip":1251.2,"melt":171.6,"boil":239,"valence":["-1","+1","+3","+5","+7"],"isotopes":[{"m":35,"s":true},{"m":37,"s":true}]},
            {"z":18,"sym":"Ar","name":"Ê∞©","enName":"Argon","mass":39.948,"cat":7,"radius":71,"en":0,"ip":1520.6,"melt":83.8,"boil":87,"valence":["0"],"isotopes":[{"m":36,"s":true},{"m":38,"s":true},{"m":40,"s":true}]},
            {"z":19,"sym":"K","name":"Èíæ","enName":"Potassium","mass":39.098,"cat":0,"radius":243,"en":0.82,"ip":418.8,"melt":336.53,"boil":1032,"valence":["+1"],"isotopes":[{"m":39,"s":true},{"m":40,"s":false},{"m":41,"s":true}]},
            {"z":20,"sym":"Ca","name":"Èíô","enName":"Calcium","mass":40.078,"cat":1,"radius":194,"en":1,"ip":589.8,"melt":1115,"boil":1757,"valence":["+2"],"isotopes":[{"m":40,"s":true},{"m":42,"s":true},{"m":44,"s":true}]},
            {"z":21,"sym":"Sc","name":"Èí™","enName":"Scandium","mass":44.956,"cat":2,"radius":184,"en":1.36,"ip":633.1,"melt":1814,"boil":3109,"valence":["+3"],"isotopes":[{"m":45,"s":true}]},
            {"z":22,"sym":"Ti","name":"Èíõ","enName":"Titanium","mass":47.867,"cat":2,"radius":176,"en":1.54,"ip":658.8,"melt":1941,"boil":3560,"valence":["+2","+3","+4"],"isotopes":[{"m":46,"s":true},{"m":47,"s":true},{"m":48,"s":true},{"m":49,"s":true},{"m":50,"s":true}]},
            {"z":23,"sym":"V","name":"Èíí","enName":"Vanadium","mass":50.942,"cat":2,"radius":171,"en":1.63,"ip":650.9,"melt":2183,"boil":3680,"valence":["+2","+3","+4","+5"],"isotopes":[{"m":50,"s":true},{"m":51,"s":true}]},
            {"z":24,"sym":"Cr","name":"Èì¨","enName":"Chromium","mass":51.996,"cat":2,"radius":166,"en":1.66,"ip":652.9,"melt":2180,"boil":2944,"valence":["+2","+3","+6"],"isotopes":[{"m":50,"s":true},{"m":52,"s":true},{"m":53,"s":true},{"m":54,"s":true}]},
            {"z":25,"sym":"Mn","name":"Èî∞","enName":"Manganese","mass":54.938,"cat":2,"radius":161,"en":1.55,"ip":717.1,"melt":1519,"boil":2334,"valence":["+2","+4","+7"],"isotopes":[{"m":55,"s":true}]},
            {"z":26,"sym":"Fe","name":"ÈìÅ","enName":"Iron","mass":55.845,"cat":2,"radius":156,"en":1.83,"ip":762.5,"melt":1811,"boil":3134,"valence":["+2","+3"],"isotopes":[{"m":54,"s":true},{"m":56,"s":true},{"m":57,"s":true},{"m":58,"s":true}]},
            {"z":27,"sym":"Co","name":"Èí¥","enName":"Cobalt","mass":58.933,"cat":2,"radius":152,"en":1.88,"ip":760.4,"melt":1768,"boil":3200,"valence":["+2","+3"],"isotopes":[{"m":59,"s":true}]},
            {"z":28,"sym":"Ni","name":"Èïç","enName":"Nickel","mass":58.693,"cat":2,"radius":149,"en":1.91,"ip":737.1,"melt":1728,"boil":3186,"valence":["+2","+3"],"isotopes":[{"m":58,"s":true},{"m":60,"s":true},{"m":61,"s":true},{"m":62,"s":true},{"m":64,"s":true}]},
            {"z":29,"sym":"Cu","name":"Èìú","enName":"Copper","mass":63.546,"cat":2,"radius":145,"en":1.9,"ip":745.5,"melt":1357.77,"boil":2835,"valence":["+1","+2"],"isotopes":[{"m":63,"s":true},{"m":65,"s":true}]},
            {"z":30,"sym":"Zn","name":"Èîå","enName":"Zinc","mass":65.38,"cat":2,"radius":142,"en":1.65,"ip":906.4,"melt":692.68,"boil":1180,"valence":["+2"],"isotopes":[{"m":64,"s":true},{"m":66,"s":true},{"m":67,"s":true},{"m":68,"s":true},{"m":70,"s":true}]},
            {"z":31,"sym":"Ga","name":"Èïì","enName":"Gallium","mass":69.723,"cat":3,"radius":136,"en":1.81,"ip":578.8,"melt":302.91,"boil":2477,"valence":["+3"],"isotopes":[{"m":69,"s":true},{"m":71,"s":true}]},
            {"z":32,"sym":"Ge","name":"Èîó","enName":"Germanium","mass":72.63,"cat":4,"radius":125,"en":2.01,"ip":762,"melt":1211.4,"boil":3106,"valence":["-4","+2","+4"],"isotopes":[{"m":70,"s":true},{"m":72,"s":true},{"m":73,"s":true},{"m":74,"s":true},{"m":76,"s":true}]},
            {"z":33,"sym":"As","name":"Á†∑","enName":"Arsenic","mass":74.922,"cat":4,"radius":114,"en":2.18,"ip":947,"melt":1090,"boil":887,"valence":["-3","+3","+5"],"isotopes":[{"m":75,"s":true}]},
            {"z":34,"sym":"Se","name":"Á°í","enName":"Selenium","mass":78.971,"cat":5,"radius":103,"en":2.55,"ip":941,"melt":494,"boil":958,"valence":["-2","+4","+6"],"isotopes":[{"m":74,"s":true},{"m":76,"s":true},{"m":77,"s":true},{"m":78,"s":true},{"m":80,"s":true},{"m":82,"s":true}]},
            {"z":35,"sym":"Br","name":"Ê∫¥","enName":"Bromine","mass":79.904,"cat":6,"radius":94,"en":2.96,"ip":1139.9,"melt":265.8,"boil":332,"valence":["-1","+1","+5"],"isotopes":[{"m":79,"s":true},{"m":81,"s":true}]},
            {"z":36,"sym":"Kr","name":"Ê∞™","enName":"Krypton","mass":83.798,"cat":7,"radius":87,"en":3,"ip":1350.8,"melt":115.79,"boil":120,"valence":["0","+2"],"isotopes":[{"m":78,"s":true},{"m":80,"s":true},{"m":82,"s":true},{"m":83,"s":true},{"m":84,"s":true},{"m":86,"s":true}]},
            {"z":37,"sym":"Rb","name":"Èì∑","enName":"Rubidium","mass":85.468,"cat":0,"radius":265,"en":0.82,"ip":403,"melt":312.46,"boil":961,"valence":["+1"],"isotopes":[{"m":85,"s":true},{"m":87,"s":false}]},
            {"z":38,"sym":"Sr","name":"Èî∂","enName":"Strontium","mass":87.62,"cat":1,"radius":219,"en":0.95,"ip":549.5,"melt":1050,"boil":1655,"valence":["+2"],"isotopes":[{"m":84,"s":true},{"m":86,"s":true},{"m":87,"s":true},{"m":88,"s":true}]},
            {"z":39,"sym":"Y","name":"Èíá","enName":"Yttrium","mass":88.906,"cat":2,"radius":212,"en":1.22,"ip":600,"melt":1799,"boil":3609,"valence":["+3"],"isotopes":[{"m":89,"s":true}]},
            {"z":40,"sym":"Zr","name":"ÈîÜ","enName":"Zirconium","mass":91.224,"cat":2,"radius":206,"en":1.33,"ip":640.1,"melt":2128,"boil":4682,"valence":["+4"],"isotopes":[{"m":90,"s":true},{"m":91,"s":true},{"m":92,"s":true},{"m":94,"s":true},{"m":96,"s":false}]},
            {"z":41,"sym":"Nb","name":"Èìå","enName":"Niobium","mass":92.906,"cat":2,"radius":198,"en":1.66,"ip":652.1,"melt":2750,"boil":5017,"valence":["+3","+5"],"isotopes":[{"m":93,"s":true}]},
            {"z":42,"sym":"Mo","name":"Èíº","enName":"Molybdenum","mass":95.95,"cat":2,"radius":190,"en":2.16,"ip":684.3,"melt":2896,"boil":4912,"valence":["+2","+3","+4","+6"],"isotopes":[{"m":92,"s":true},{"m":94,"s":true},{"m":95,"s":true},{"m":96,"s":true},{"m":97,"s":true},{"m":98,"s":true},{"m":100,"s":false}]},
            {"z":43,"sym":"Tc","name":"Èîù","enName":"Technetium","mass":98,"cat":2,"radius":183,"en":1.97,"ip":702,"melt":2430,"boil":4538,"valence":["+4","+7"],"isotopes":[{"m":97,"s":false},{"m":98,"s":false},{"m":99,"s":false}]},
            {"z":44,"sym":"Ru","name":"Èíå","enName":"Ruthenium","mass":101.07,"cat":2,"radius":178,"en":2.2,"ip":710.2,"melt":2607,"boil":4423,"valence":["+2","+3","+4"],"isotopes":[{"m":96,"s":true},{"m":98,"s":true},{"m":99,"s":true},{"m":100,"s":true},{"m":101,"s":true},{"m":102,"s":true},{"m":104,"s":true}]},
            {"z":45,"sym":"Rh","name":"Èìë","enName":"Rhodium","mass":102.91,"cat":2,"radius":173,"en":2.28,"ip":719.7,"melt":2237,"boil":3968,"valence":["+3"],"isotopes":[{"m":103,"s":true}]},
            {"z":46,"sym":"Pd","name":"ÈíØ","enName":"Palladium","mass":106.42,"cat":2,"radius":169,"en":2.2,"ip":804.4,"melt":1828,"boil":3236,"valence":["+2","+4"],"isotopes":[{"m":102,"s":true},{"m":104,"s":true},{"m":105,"s":true},{"m":106,"s":true},{"m":108,"s":true},{"m":110,"s":true}]},
            {"z":47,"sym":"Ag","name":"Èì∂","enName":"Silver","mass":107.87,"cat":2,"radius":165,"en":1.93,"ip":731,"melt":1234.9,"boil":2435,"valence":["+1"],"isotopes":[{"m":107,"s":true},{"m":109,"s":true}]},
            {"z":48,"sym":"Cd","name":"Èïâ","enName":"Cadmium","mass":112.41,"cat":2,"radius":161,"en":1.69,"ip":867.8,"melt":594.22,"boil":1040,"valence":["+2"],"isotopes":[{"m":106,"s":true},{"m":108,"s":true},{"m":110,"s":true},{"m":111,"s":true},{"m":112,"s":true},{"m":113,"s":false},{"m":114,"s":true},{"m":116,"s":false}]},
            {"z":49,"sym":"In","name":"Èìü","enName":"Indium","mass":114.82,"cat":3,"radius":156,"en":1.78,"ip":558.3,"melt":429.75,"boil":2345,"valence":["+3"],"isotopes":[{"m":113,"s":true},{"m":115,"s":false}]},
            {"z":50,"sym":"Sn","name":"Èî°","enName":"Tin","mass":118.71,"cat":3,"radius":145,"en":1.96,"ip":708.6,"melt":505.08,"boil":2875,"valence":["+2","+4"],"isotopes":[{"m":112,"s":true},{"m":114,"s":true},{"m":115,"s":true},{"m":116,"s":true},{"m":117,"s":true},{"m":118,"s":true},{"m":119,"s":true},{"m":120,"s":true},{"m":122,"s":true},{"m":124,"s":true}]},
            {"z":51,"sym":"Sb","name":"Èîë","enName":"Antimony","mass":121.76,"cat":4,"radius":133,"en":2.05,"ip":834,"melt":903.78,"boil":1860,"valence":["-3","+3","+5"],"isotopes":[{"m":121,"s":true},{"m":123,"s":true}]},
            {"z":52,"sym":"Te","name":"Á¢≤","enName":"Tellurium","mass":127.6,"cat":4,"radius":123,"en":2.18,"ip":869.3,"melt":722.66,"boil":1261,"valence":["-2","+4","+6"],"isotopes":[{"m":120,"s":true},{"m":122,"s":true},{"m":123,"s":true},{"m":124,"s":true},{"m":125,"s":true},{"m":126,"s":true},{"m":128,"s":false},{"m":130,"s":false}]},
            {"z":53,"sym":"I","name":"Á¢ò","enName":"Iodine","mass":126.9,"cat":6,"radius":115,"en":2.66,"ip":1008.4,"melt":386.85,"boil":457,"valence":["-1","+1","+5","+7"],"isotopes":[{"m":127,"s":true}]},
            {"z":54,"sym":"Xe","name":"Ê∞ô","enName":"Xenon","mass":131.29,"cat":7,"radius":108,"en":2.61,"ip":1170.4,"melt":161.4,"boil":165,"valence":["0","+2","+4","+6"],"isotopes":[{"m":124,"s":true},{"m":126,"s":true},{"m":128,"s":true},{"m":129,"s":true},{"m":130,"s":true},{"m":131,"s":true},{"m":132,"s":true},{"m":134,"s":true},{"m":136,"s":false}]},
            {"z":55,"sym":"Cs","name":"ÈìØ","enName":"Cesium","mass":132.91,"cat":0,"radius":298,"en":0.79,"ip":375.7,"melt":301.7,"boil":944,"valence":["+1"],"isotopes":[{"m":133,"s":true}]},
            {"z":56,"sym":"Ba","name":"Èí°","enName":"Barium","mass":137.33,"cat":1,"radius":253,"en":0.89,"ip":502.9,"melt":1000,"boil":2170,"valence":["+2"],"isotopes":[{"m":130,"s":true},{"m":132,"s":true},{"m":134,"s":true},{"m":135,"s":true},{"m":136,"s":true},{"m":137,"s":true},{"m":138,"s":true}]},
            {"z":57,"sym":"La","name":"Èïß","enName":"Lanthanum","mass":138.91,"cat":8,"radius":195,"en":1.1,"ip":538.1,"melt":1193,"boil":3737,"valence":["+3"],"isotopes":[{"m":138,"s":false},{"m":139,"s":true}]},
            {"z":58,"sym":"Ce","name":"Èìà","enName":"Cerium","mass":140.12,"cat":8,"radius":185,"en":1.12,"ip":534.4,"melt":1068,"boil":3716,"valence":["+3","+4"],"isotopes":[{"m":136,"s":true},{"m":138,"s":true},{"m":140,"s":true},{"m":142,"s":true}]},
            {"z":59,"sym":"Pr","name":"Èï®","enName":"Praseodymium","mass":140.91,"cat":8,"radius":185,"en":1.13,"ip":527,"melt":1208,"boil":3793,"valence":["+3","+4"],"isotopes":[{"m":141,"s":true}]},
            {"z":60,"sym":"Nd","name":"Èíï","enName":"Neodymium","mass":144.24,"cat":8,"radius":185,"en":1.14,"ip":533,"melt":1297,"boil":3347,"valence":["+3"],"isotopes":[{"m":142,"s":true},{"m":143,"s":true},{"m":144,"s":false},{"m":145,"s":true},{"m":146,"s":true},{"m":148,"s":true},{"m":150,"s":false}]},
            {"z":61,"sym":"Pm","name":"Èí∑","enName":"Promethium","mass":145,"cat":8,"radius":185,"en":1.13,"ip":540,"melt":1315,"boil":3273,"valence":["+3"],"isotopes":[{"m":145,"s":false},{"m":147,"s":false}]},
            {"z":62,"sym":"Sm","name":"Èíê","enName":"Samarium","mass":150.36,"cat":8,"radius":185,"en":1.17,"ip":545,"melt":1345,"boil":2067,"valence":["+2","+3"],"isotopes":[{"m":144,"s":true},{"m":147,"s":false},{"m":148,"s":false},{"m":149,"s":false},{"m":150,"s":true},{"m":152,"s":true},{"m":154,"s":true}]},
            {"z":63,"sym":"Eu","name":"Èìï","enName":"Europium","mass":151.96,"cat":8,"radius":185,"en":1.2,"ip":547,"melt":1099,"boil":1802,"valence":["+2","+3"],"isotopes":[{"m":151,"s":true},{"m":153,"s":true}]},
            {"z":64,"sym":"Gd","name":"ÈíÜ","enName":"Gadolinium","mass":157.25,"cat":8,"radius":180,"en":1.2,"ip":593.4,"melt":1585,"boil":3546,"valence":["+3"],"isotopes":[{"m":152,"s":false},{"m":154,"s":true},{"m":155,"s":true},{"m":156,"s":true},{"m":157,"s":true},{"m":158,"s":true},{"m":160,"s":true}]},
            {"z":65,"sym":"Tb","name":"ÈìΩ","enName":"Terbium","mass":158.93,"cat":8,"radius":175,"en":1.2,"ip":566,"melt":1629,"boil":3503,"valence":["+3","+4"],"isotopes":[{"m":159,"s":true}]},
            {"z":66,"sym":"Dy","name":"Èïù","enName":"Dysprosium","mass":162.5,"cat":8,"radius":175,"en":1.22,"ip":573,"melt":1680,"boil":2840,"valence":["+3"],"isotopes":[{"m":156,"s":true},{"m":158,"s":true},{"m":160,"s":true},{"m":161,"s":true},{"m":162,"s":true},{"m":163,"s":true},{"m":164,"s":true}]},
            {"z":67,"sym":"Ho","name":"Èí¨","enName":"Holmium","mass":164.93,"cat":8,"radius":175,"en":1.23,"ip":581,"melt":1734,"boil":2993,"valence":["+3"],"isotopes":[{"m":165,"s":true}]},
            {"z":68,"sym":"Er","name":"Èìí","enName":"Erbium","mass":167.26,"cat":8,"radius":175,"en":1.24,"ip":589,"melt":1802,"boil":3141,"valence":["+3"],"isotopes":[{"m":162,"s":true},{"m":164,"s":true},{"m":166,"s":true},{"m":167,"s":true},{"m":168,"s":true},{"m":170,"s":true}]},
            {"z":69,"sym":"Tm","name":"Èì•","enName":"Thulium","mass":168.93,"cat":8,"radius":175,"en":1.25,"ip":597,"melt":1818,"boil":2223,"valence":["+2","+3"],"isotopes":[{"m":169,"s":true}]},
            {"z":70,"sym":"Yb","name":"Èï±","enName":"Ytterbium","mass":173.05,"cat":8,"radius":175,"en":1.1,"ip":603,"melt":1097,"boil":1469,"valence":["+2","+3"],"isotopes":[{"m":168,"s":true},{"m":170,"s":true},{"m":171,"s":true},{"m":172,"s":true},{"m":173,"s":true},{"m":174,"s":true},{"m":176,"s":true}]},
            {"z":71,"sym":"Lu","name":"Èï•","enName":"Lutetium","mass":174.97,"cat":8,"radius":175,"en":1.27,"ip":523.5,"melt":1925,"boil":3675,"valence":["+3"],"isotopes":[{"m":175,"s":true},{"m":176,"s":false}]},
            {"z":72,"sym":"Hf","name":"Èì™","enName":"Hafnium","mass":178.49,"cat":2,"radius":208,"en":1.36,"ip":658.5,"melt":2506,"boil":4876,"valence":["+4"],"isotopes":[{"m":174,"s":false},{"m":176,"s":true},{"m":177,"s":true},{"m":178,"s":true},{"m":179,"s":true},{"m":180,"s":true}]},
            {"z":73,"sym":"Ta","name":"ÈíΩ","enName":"Tantalum","mass":180.95,"cat":2,"radius":200,"en":1.5,"ip":761,"melt":3290,"boil":5731,"valence":["+5"],"isotopes":[{"m":180,"s":false},{"m":181,"s":true}]},
            {"z":74,"sym":"W","name":"Èí®","enName":"Tungsten","mass":183.84,"cat":2,"radius":193,"en":2.36,"ip":770,"melt":3695,"boil":5828,"valence":["+2","+4","+6"],"isotopes":[{"m":180,"s":true},{"m":182,"s":true},{"m":183,"s":true},{"m":184,"s":true},{"m":186,"s":true}]},
            {"z":75,"sym":"Re","name":"Èìº","enName":"Rhenium","mass":186.21,"cat":2,"radius":188,"en":1.9,"ip":760,"melt":3459,"boil":5869,"valence":["+4","+6","+7"],"isotopes":[{"m":185,"s":true},{"m":187,"s":false}]},
            {"z":76,"sym":"Os","name":"Èîá","enName":"Osmium","mass":190.23,"cat":2,"radius":185,"en":2.2,"ip":840,"melt":3306,"boil":5285,"valence":["+3","+4","+8"],"isotopes":[{"m":184,"s":true},{"m":186,"s":true},{"m":187,"s":true},{"m":188,"s":true},{"m":189,"s":true},{"m":190,"s":true},{"m":192,"s":true}]},
            {"z":77,"sym":"Ir","name":"Èì±","enName":"Iridium","mass":192.22,"cat":2,"radius":180,"en":2.2,"ip":880,"melt":2719,"boil":4701,"valence":["+3","+4"],"isotopes":[{"m":191,"s":true},{"m":193,"s":true}]},
            {"z":78,"sym":"Pt","name":"ÈìÇ","enName":"Platinum","mass":195.08,"cat":2,"radius":177,"en":2.28,"ip":870,"melt":2041,"boil":4098,"valence":["+2","+4"],"isotopes":[{"m":190,"s":false},{"m":192,"s":true},{"m":194,"s":true},{"m":195,"s":true},{"m":196,"s":true},{"m":198,"s":true}]},
            {"z":79,"sym":"Au","name":"Èáë","enName":"Gold","mass":196.97,"cat":2,"radius":174,"en":2.54,"ip":890.1,"melt":1337,"boil":3129,"valence":["+1","+3"],"isotopes":[{"m":197,"s":true}]},
            {"z":80,"sym":"Hg","name":"Ê±û","enName":"Mercury","mass":200.59,"cat":2,"radius":171,"en":2,"ip":1007,"melt":234.3,"boil":630,"valence":["+1","+2"],"isotopes":[{"m":196,"s":true},{"m":198,"s":true},{"m":199,"s":true},{"m":200,"s":true},{"m":201,"s":true},{"m":202,"s":true},{"m":204,"s":true}]},
            {"z":81,"sym":"Tl","name":"Èìä","enName":"Thallium","mass":204.38,"cat":3,"radius":156,"en":1.62,"ip":589,"melt":577,"boil":1746,"valence":["+1","+3"],"isotopes":[{"m":203,"s":true},{"m":205,"s":true}]},
            {"z":82,"sym":"Pb","name":"ÈìÖ","enName":"Lead","mass":207.2,"cat":3,"radius":154,"en":2.33,"ip":715.6,"melt":600.6,"boil":2022,"valence":["+2","+4"],"isotopes":[{"m":204,"s":true},{"m":206,"s":true},{"m":207,"s":true},{"m":208,"s":true}]},
            {"z":83,"sym":"Bi","name":"Èìã","enName":"Bismuth","mass":208.98,"cat":3,"radius":143,"en":2.02,"ip":703,"melt":544,"boil":1837,"valence":["+3","+5"],"isotopes":[{"m":209,"s":false}]},
            {"z":84,"sym":"Po","name":"Èíã","enName":"Polonium","mass":209,"cat":4,"radius":135,"en":2,"ip":812,"melt":527,"boil":1235,"valence":["+2","+4"],"isotopes":[{"m":208,"s":false},{"m":209,"s":false},{"m":210,"s":false}]},
            {"z":85,"sym":"At","name":"Á†π","enName":"Astatine","mass":210,"cat":6,"radius":127,"en":2.2,"ip":899,"melt":575,"boil":610,"valence":["-1","+1","+5"],"isotopes":[{"m":210,"s":false},{"m":211,"s":false}]},
            {"z":86,"sym":"Rn","name":"Ê∞°","enName":"Radon","mass":222,"cat":7,"radius":120,"en":2.2,"ip":1037,"melt":202,"boil":211,"valence":["0","+2"],"isotopes":[{"m":211,"s":false},{"m":220,"s":false},{"m":222,"s":false}]},
            {"z":87,"sym":"Fr","name":"Èí´","enName":"Francium","mass":348,"cat":0,"radius":348,"en":0.7,"ip":380,"melt":300,"boil":950,"valence":["+1"],"isotopes":[{"m":223,"s":false}]},
            {"z":88,"sym":"Ra","name":"Èï≠","enName":"Radium","mass":283,"cat":1,"radius":283,"en":0.9,"ip":509.3,"melt":973,"boil":2010,"valence":["+2"],"isotopes":[{"m":223,"s":false},{"m":224,"s":false},{"m":226,"s":false},{"m":228,"s":false}]},
            {"z":89,"sym":"Ac","name":"Èîï","enName":"Actinium","mass":227,"cat":9,"radius":260,"en":1.1,"ip":499,"melt":1323,"boil":3471,"valence":["+3"],"isotopes":[{"m":227,"s":false}]},
            {"z":90,"sym":"Th","name":"Èíç","enName":"Thorium","mass":232.04,"cat":9,"radius":179,"en":1.3,"ip":587,"melt":2115,"boil":5061,"valence":["+4"],"isotopes":[{"m":230,"s":false},{"m":232,"s":false}]},
            {"z":91,"sym":"Pa","name":"Èï§","enName":"Protactinium","mass":231.04,"cat":9,"radius":180,"en":1.5,"ip":568,"melt":1841,"boil":4300,"valence":["+4","+5"],"isotopes":[{"m":231,"s":false}]},
            {"z":92,"sym":"U","name":"ÈìÄ","enName":"Uranium","mass":238.03,"cat":9,"radius":156,"en":1.38,"ip":597.6,"melt":1405,"boil":4404,"valence":["+3","+4","+5","+6"],"isotopes":[{"m":234,"s":false},{"m":235,"s":false},{"m":238,"s":false}]},
            {"z":93,"sym":"Np","name":"Èïé","enName":"Neptunium","mass":237,"cat":9,"radius":175,"en":1.36,"ip":605,"melt":917,"boil":4273,"valence":["+3","+4","+5","+6"],"isotopes":[{"m":237,"s":false}]},
            {"z":94,"sym":"Pu","name":"Èíö","enName":"Plutonium","mass":244,"cat":9,"radius":159,"en":1.28,"ip":584.7,"melt":912,"boil":3501,"valence":["+3","+4","+5","+6"],"isotopes":[{"m":238,"s":false},{"m":239,"s":false},{"m":240,"s":false},{"m":244,"s":false}]},
            {"z":95,"sym":"Am","name":"ÈïÖ","enName":"Americium","mass":243,"cat":9,"radius":173,"en":1.13,"ip":578,"melt":1449,"boil":2880,"valence":["+3","+4","+5","+6"],"isotopes":[{"m":241,"s":false},{"m":243,"s":false}]},
            {"z":96,"sym":"Cm","name":"Èîî","enName":"Curium","mass":247,"cat":9,"radius":176,"en":1.28,"ip":581,"melt":1613,"boil":3383,"valence":["+3","+4"],"isotopes":[{"m":245,"s":false},{"m":247,"s":false},{"m":248,"s":false}]},
            {"z":97,"sym":"Bk","name":"Èî´","enName":"Berkelium","mass":247,"cat":9,"radius":176,"en":1.3,"ip":601,"melt":1259,"boil":2900,"valence":["+3","+4"],"isotopes":[{"m":247,"s":false},{"m":249,"s":false}]},
            {"z":98,"sym":"Cf","name":"Èîé","enName":"Californium","mass":251,"cat":9,"radius":176,"en":1.3,"ip":608,"melt":1173,"boil":1743,"valence":["+3","+4"],"isotopes":[{"m":249,"s":false},{"m":251,"s":false},{"m":252,"s":false}]},
            {"z":99,"sym":"Es","name":"Èîø","enName":"Einsteinium","mass":252,"cat":9,"radius":176,"en":1.3,"ip":619,"melt":1133,"boil":1269,"valence":["+2","+3"],"isotopes":[{"m":252,"s":false},{"m":254,"s":false}]},
            {"z":100,"sym":"Fm","name":"ÈïÑ","enName":"Fermium","mass":257,"cat":9,"radius":176,"en":1.3,"ip":629,"melt":1800,"boil":0,"valence":["+2","+3"],"isotopes":[{"m":253,"s":false},{"m":257,"s":false}]},
            {"z":101,"sym":"Md","name":"Èíî","enName":"Mendelevium","mass":258,"cat":9,"radius":176,"en":1.3,"ip":635,"melt":1100,"boil":0,"valence":["+2","+3"],"isotopes":[{"m":258,"s":false},{"m":260,"s":false}]},
            {"z":102,"sym":"No","name":"Èîò","enName":"Nobelium","mass":259,"cat":9,"radius":176,"en":1.3,"ip":642,"melt":1100,"boil":0,"valence":["+2","+3"],"isotopes":[{"m":259,"s":false}]},
            {"z":103,"sym":"Lr","name":"Èìπ","enName":"Lawrencium","mass":266,"cat":9,"radius":176,"en":1.3,"ip":470,"melt":1900,"boil":0,"valence":["+3"],"isotopes":[{"m":262,"s":false},{"m":266,"s":false}]},
            {"z":104,"sym":"Rf","name":"¨¨ª","enName":"Rutherfordium","mass":267,"cat":2,"radius":150,"en":0,"ip":580,"melt":2400,"boil":5800,"valence":["+4"],"isotopes":[{"m":267,"s":false}]},
            {"z":105,"sym":"Db","name":"¨≠ä","enName":"Dubnium","mass":268,"cat":2,"radius":149,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+5"],"isotopes":[{"m":268,"s":false}]},
            {"z":106,"sym":"Sg","name":"¨≠≥","enName":"Seaborgium","mass":269,"cat":2,"radius":132,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+6"],"isotopes":[{"m":269,"s":false}]},
            {"z":107,"sym":"Bh","name":"¨≠õ","enName":"Bohrium","mass":270,"cat":2,"radius":141,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+7"],"isotopes":[{"m":270,"s":false}]},
            {"z":108,"sym":"Hs","name":"¨≠∂","enName":"Hassium","mass":269,"cat":2,"radius":134,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+8"],"isotopes":[{"m":269,"s":false}]},
            {"z":109,"sym":"Mt","name":"Èøè","enName":"Meitnerium","mass":278,"cat":2,"radius":129,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+3","+6"],"isotopes":[{"m":278,"s":false}]},
            {"z":110,"sym":"Ds","name":"´üº","enName":"Darmstadtium","mass":281,"cat":2,"radius":128,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+2","+4","+6"],"isotopes":[{"m":281,"s":false}]},
            {"z":111,"sym":"Rg","name":"¨¨≠","enName":"Roentgenium","mass":282,"cat":2,"radius":121,"en":0,"ip":0,"melt":0,"boil":0,"valence":["+3","+5"],"isotopes":[{"m":282,"s":false}]},
            {"z":112,"sym":"Cn","name":"Èøî","enName":"Copernicium","mass":285,"cat":2,"radius":122,"en":0,"ip":0,"melt":283,"boil":340,"valence":["+2"],"isotopes":[{"m":285,"s":false}]},
            {"z":113,"sym":"Nh","name":"Èø≠","enName":"Nihonium","mass":286,"cat":3,"radius":136,"en":0,"ip":0,"melt":700,"boil":1400,"valence":["+1","+3"],"isotopes":[{"m":286,"s":false}]},
            {"z":114,"sym":"Fl","name":"´ìß","enName":"Flerovium","mass":289,"cat":3,"radius":143,"en":0,"ip":0,"melt":340,"boil":380,"valence":["+2"],"isotopes":[{"m":289,"s":false}]},
            {"z":115,"sym":"Mc","name":"ÈïÜ","enName":"Moscovium","mass":290,"cat":3,"radius":162,"en":0,"ip":0,"melt":700,"boil":1400,"valence":["+1","+3"],"isotopes":[{"m":290,"s":false}]},
            {"z":116,"sym":"Lv","name":"´ü∑","enName":"Livermorium","mass":293,"cat":3,"radius":175,"en":0,"ip":0,"melt":700,"boil":1100,"valence":["+2","+4"],"isotopes":[{"m":293,"s":false}]},
            {"z":117,"sym":"Ts","name":"Èø¨","enName":"Tennessine","mass":294,"cat":6,"radius":165,"en":0,"ip":0,"melt":700,"boil":883,"valence":["-1","+1","+3"],"isotopes":[{"m":294,"s":false}]},
            {"z":118,"sym":"Og","name":"Èø´","enName":"Oganesson","mass":294,"cat":7,"radius":152,"en":0,"ip":0,"melt":325,"boil":450,"valence":["0","+2","+4"],"isotopes":[{"m":294,"s":false}]}
        ];

        const categories = [
            { name: "Á¢±ÈáëÂ±û", color: "#ff5252" }, 
            { name: "Á¢±ÂúüÈáëÂ±û", color: "#ffb142" },
            { name: "ËøáÊ∏°ÈáëÂ±û", color: "#706fd3" }, 
            { name: "ÂêéËøáÊ∏°ÈáëÂ±û", color: "#33d9b2" },
            { name: "Á±ªÈáëÂ±û", color: "#34ace0" }, 
            { name: "ÈùûÈáëÂ±û", color: "#ffda79" },
            { name: "Âç§Á¥†", color: "#218c74" }, 
            { name: "Á®ÄÊúâÊ∞î‰Ωì", color: "#b33939" },
            { name: "ÈïßÁ≥ª", color: "#f78fb3" }, 
            { name: "ÈîïÁ≥ª", color: "#cd84f1" }
        ];

        const elements = elementsData.map(e => ({
            idx: e.z,
            sym: e.sym,
            name: e.name,
            enName: e.enName,
            mass: e.mass,
            cat: categories[e.cat],
            catId: e.cat,
            radius: e.radius || 0,
            en: e.en || 0,
            ip: e.ip || 0,
            melt: e.melt || 0,
            boil: e.boil || 0,
            valence: e.valence || [],
            isotopes: e.isotopes || []
        }));

        const orbitals = ['1s','2s','2p','3s','3p','4s','3d','4p','5s','4d','5p','6s','4f','5d','6p','7s','5f','6d','7p'];
        const capacities = {s:2, p:6, d:10, f:14};

        const exceptions = {
            24: {'4s':1, '3d':5}, 29: {'4s':1, '3d':10},
            41: {'5s':1, '4d':4}, 42: {'5s':1, '4d':5},
            44: {'5s':1, '4d':7}, 45: {'5s':1, '4d':8},
            46: {'5s':0, '4d':10}, 47: {'5s':1, '4d':10},
            78: {'6s':1, '5d':9}, 79: {'6s':1, '5d':10}
        };

        function getElectronData(Z) {
            let config = {};
            let remaining = Z;

            for (let orb of orbitals) {
                if (remaining <= 0) break;
                let type = orb.charAt(1);
                let cap = capacities[type];
                let fill = Math.min(remaining, cap);
                config[orb] = fill;
                remaining -= fill;
            }

            if (exceptions[Z]) {
                const patch = exceptions[Z];
                for (let orb in patch) {
                    config[orb] = patch[orb];
                }
            }

            const sortOrb = (a, b) => {
                let n1 = parseInt(a[0]), n2 = parseInt(b[0]);
                if(n1 !== n2) return n1 - n2;
                const order = "spdf";
                return order.indexOf(a[1]) - order.indexOf(b[1]);
            };

            const configStr = Object.keys(config)
                .filter(k => config[k] > 0)
                .sort(sortOrb)
                .map(k => `${k}<sup>${config[k]}</sup>`)
                .join(' ');

            let shells = [];
            Object.keys(config).forEach(orb => {
                let n = parseInt(orb[0]);
                shells[n-1] = (shells[n-1] || 0) + config[orb];
            });

            for(let i=0; i<shells.length; i++) { if(!shells[i]) shells[i]=0; }

            return { str: configStr, shells: shells };
        }

        const table = document.getElementById('table');
        const legend = document.getElementById('legend');
        let currentActiveCategory = null;

        function getPos(n) {
            if (n==1) return [1,1]; if (n==2) return [1,18];
            if (n>=3 && n<=4) return [2,n-2]; if (n>=5 && n<=10) return [2,n+8];
            if (n>=11 && n<=12) return [3,n-10]; if (n>=13 && n<=18) return [3,n];
            if (n>=19 && n<=36) return [4,n-18];
            if (n>=37 && n<=54) return [5,n-36];
            if (n>=55 && n<=56) return [6,n-54]; if (n>=72 && n<=86) return [6,n-68];
            if (n>=87 && n<=88) return [7,n-86]; if (n>=104 && n<=118) return [7,n-100];
            if (n>=57 && n<=71) return [9,n-53]; if (n>=89 && n<=103) return [10,n-85];
            return [0,0];
        }

        function init() {
            categories.forEach((c, i) => {
                const btn = document.createElement('div');
                btn.className = 'legend-item';
                btn.innerHTML = `<div class="legend-color" style="background:${c.color}"></div>${c.name}`;
                btn.onclick = () => toggleCategory(i, btn);
                legend.appendChild(btn);
            });

            elements.forEach((e, i) => {
                const [r, c] = getPos(e.idx);
                const el = document.createElement('div');
                el.className = 'element';
                el.style.gridRow = r;
                el.style.gridColumn = c;
                el.dataset.idx = e.idx;
                
                el.style.borderColor = e.cat.color;
                
                el.innerHTML = `
                    <div class="atomic-number">${e.idx}</div>
                    <div class="symbol" style="color:${e.cat.color}">${e.sym}</div>
                    <div class="name">${e.name}</div>
                    <div class="detail-val"></div>
                `;
                el.onclick = () => showModal(e);
                
                setTimeout(() => el.classList.add('visible'), i * 5);
                table.appendChild(el);
            });

            const placeholders = [
                { row: 6, col: 3, sym: "57-71", name: "ÈïßÁ≥ª", catIdx: 8, range: "La - Lu" },
                { row: 7, col: 3, sym: "89-103", name: "ÈîïÁ≥ª", catIdx: 9, range: "Ac - Lr" }
            ];

            placeholders.forEach(p => {
                const el = document.createElement('div');
                el.className = 'element placeholder';
                el.style.gridRow = p.row;
                el.style.gridColumn = p.col;
                
                const color = categories[p.catIdx].color;
                el.style.borderColor = color;
                
                el.innerHTML = `
                    <div class="range-num" style="color:${color}">${p.sym}</div>
                    <div class="name">${p.name}</div>
                `;

                el.onclick = () => {
                   const btns = document.querySelectorAll('.legend-item');
                   if(btns[p.catIdx]) btns[p.catIdx].click();
                };

                setTimeout(() => el.classList.add('visible'), 600);
                table.appendChild(el);
            });

            initDragControl();
        }

        function toggleCategory(catId, btn) {
            if (document.querySelector('.periodic-table.heatmap-active')) {
                setMode('default');
            }

            const allElements = document.querySelectorAll('.element');
            const allBtns = document.querySelectorAll('.legend-item');

            if (currentActiveCategory === catId) {
                currentActiveCategory = null;
                allBtns.forEach(b => b.classList.remove('active'));
                allElements.forEach(el => {
                    el.style.opacity = '1';
                    el.style.filter = 'none';
                });
            } else {
                currentActiveCategory = catId;
                allBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                allElements.forEach(el => {
                    if(el.dataset.idx) {
                        const data = elements[el.dataset.idx - 1];
                        if (data.catId === catId) {
                            el.style.opacity = '1';
                            el.style.filter = 'none';
                        } else {
                            el.style.opacity = '0.1';
                            el.style.filter = 'grayscale(100%)';
                        }
                    }
                    else if (el.classList.contains('placeholder')) {
                        const phName = el.querySelector('.name').innerText;
                        const isRelated = (catId === 8 && phName === 'ÈïßÁ≥ª') || (catId === 9 && phName === 'ÈîïÁ≥ª');
                        
                        if(isRelated) {
                            el.style.opacity = '1';
                            el.style.background = 'rgba(255,255,255,0.1)';
                        } else {
                            el.style.opacity = '0.3';
                            el.style.background = 'transparent';
                        }
                    }
                });
            }
        }

        function setMode(mode) {
            currentActiveCategory = null;
            document.querySelectorAll('.legend-item').forEach(b => b.classList.remove('active'));

            const domElements = document.querySelectorAll('.element');
            const btns = document.querySelectorAll('.mode-btn');
            
            btns.forEach(b => b.classList.remove('active'));
            document.querySelector(`button[onclick="setMode('${mode}')"]`).classList.add('active');

            if (mode === 'default') {
                table.classList.remove('heatmap-active');
                domElements.forEach(el => {
                    if(el.classList.contains('placeholder')) {
                        el.style.background = 'rgba(255,255,255,0.01)';
                        el.style.opacity = '1';
                        return;
                    }

                    const data = elements[el.dataset.idx - 1];
                    el.style.background = 'var(--card-bg)';
                    el.style.borderColor = data.cat.color;
                    el.querySelector('.symbol').style.color = data.cat.color;
                    el.style.opacity = '1';
                    el.style.filter = 'none';
                });
                return;
            }

            table.classList.add('heatmap-active');

            let maxVal = -Infinity, minVal = Infinity;
            elements.forEach(e => {
                let val = e[mode];
                if (val > 0) {
                    if (val > maxVal) maxVal = val;
                    if (val < minVal) minVal = val;
                }
            });

            domElements.forEach(el => {
                if(el.classList.contains('placeholder')) {
                    el.style.opacity = '0.1';
                    return;
                }

                const data = elements[el.dataset.idx - 1];
                const val = data[mode];
                const displayDiv = el.querySelector('.detail-val');
                
                el.style.opacity = '1';
                el.style.filter = 'none';
                
                if (val === 0) {
                    el.style.background = '#222';
                    el.style.borderColor = '#444';
                    displayDiv.innerText = '-';
                } else {
                    let ratio = (val - minVal) / (maxVal - minVal);
                    let hue = 240 - (ratio * 240); 
                    el.style.background = `hsla(${hue}, 70%, 40%, 0.8)`;
                    el.style.borderColor = `hsla(${hue}, 100%, 70%, 1)`;
                    el.querySelector('.symbol').style.color = '#fff';
                    displayDiv.innerText = val;
                }
            });
        }

        const modal = document.getElementById('modal');
        const atomContainer = document.getElementById('atomContainer');

        function render3DAtom(Z) {
            atomContainer.innerHTML = '';
            
            const nucleus = document.createElement('div');
            nucleus.className = 'nucleus';
            atomContainer.appendChild(nucleus);

            const { shells } = getElectronData(Z);
            
            shells.forEach((count, idx) => {
                if (count === 0) return;
                const isValence = (idx === shells.length - 1);
                const size = 40 + (idx * 25);
                
                const orbit = document.createElement('div');
                orbit.className = 'orbit-ring';
                orbit.style.width = `${size}px`; 
                orbit.style.height = `${size}px`;
                orbit.style.top = `calc(50% - ${size/2}px)`; 
                orbit.style.left = `calc(50% - ${size/2}px)`;
                
                const rx = Math.random()*360, ry = Math.random()*360;
                orbit.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
                
                const animDuration = 5 + idx * 2;
                orbit.animate([
                    { transform: `rotateX(${rx}deg) rotateY(${ry}deg) rotateZ(0deg)` },
                    { transform: `rotateX(${rx}deg) rotateY(${ry}deg) rotateZ(360deg)` }
                ], {
                    duration: animDuration * 1000,
                    iterations: Infinity,
                    easing: 'linear'
                });

                for(let i=0; i<count; i++) {
                    const electron = document.createElement('div');
                    electron.className = `electron ${isValence ? 'valence' : 'inner'}`;
                    const angle = (360/count) * i;
                    electron.style.transform = `rotate(${angle}deg) translateX(${size/2}px)`;
                    orbit.appendChild(electron);
                }
                atomContainer.appendChild(orbit);
            });
            return shells;
        }

        let rotX = 0;
        let rotY = 0;
        let isDragging = false;
        let lastMouseX, lastMouseY;

        function initDragControl() {
            const wrapper = document.getElementById('atomWrapper');

            wrapper.addEventListener('mousedown', (e) => {
                isDragging = true;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
            });

            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const dx = e.clientX - lastMouseX;
                const dy = e.clientY - lastMouseY;
                
                rotY += dx * 0.5;
                rotX -= dy * 0.5;

                atomContainer.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
                
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
            });

            window.addEventListener('mouseup', () => isDragging = false);

            wrapper.addEventListener('touchstart', (e) => {
                isDragging = true;
                lastMouseX = e.touches[0].clientX;
                lastMouseY = e.touches[0].clientY;
            }, { passive: true });

            window.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                const dx = e.touches[0].clientX - lastMouseX;
                const dy = e.touches[0].clientY - lastMouseY;
                
                rotY += dx * 0.8;
                rotX -= dy * 0.8;

                atomContainer.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
                
                lastMouseX = e.touches[0].clientX;
                lastMouseY = e.touches[0].clientY;
            }, { passive: true });

            window.addEventListener('touchend', () => isDragging = false);
        }

        function showModal(data) {
            rotX = 0; 
            rotY = 0;
            atomContainer.style.transform = `rotateX(0deg) rotateY(0deg)`;

            document.getElementById('m-symbol').innerText = data.sym;
            document.getElementById('m-symbol').style.color = data.cat.color;
            document.getElementById('m-name').innerText = data.name;
            document.getElementById('m-en-name').innerText = data.enName;
            document.getElementById('m-cat').innerText = data.cat.name;
            document.getElementById('m-cat').style.borderColor = data.cat.color;
            document.getElementById('m-cat').style.color = data.cat.color;
            
            document.getElementById('m-num').innerText = data.idx;
            document.getElementById('m-mass').innerText = data.mass;
            document.getElementById('m-melt').innerText = data.melt || "‚Äî";
            document.getElementById('m-boil').innerText = data.boil || "‚Äî";
            document.getElementById('m-radius').innerText = data.radius || "‚Äî";
            document.getElementById('m-en').innerText = data.en || "‚Äî";
            document.getElementById('m-ip').innerText = data.ip || "‚Äî";

            const valenceContainer = document.getElementById('m-valence');
            valenceContainer.innerHTML = '';
            if (data.valence && data.valence.length > 0) {
                data.valence.forEach(v => {
                    const tag = document.createElement('span');
                    tag.className = 'valence-tag';
                    tag.textContent = v;
                    valenceContainer.appendChild(tag);
                });
            } else {
                valenceContainer.innerHTML = '<span style="color:#666">ÊöÇÊó†Êï∞ÊçÆ</span>';
            }

            const isotopeContainer = document.getElementById('m-isotopes');
            isotopeContainer.innerHTML = '';
            if (data.isotopes && data.isotopes.length > 0) {
                data.isotopes.forEach(iso => {
                    const tag = document.createElement('span');
                    tag.className = `isotope-tag ${iso.s ? 'isotope-stable' : ''}`;
                    tag.innerHTML = `<span class="mass-num">${iso.m}</span>${data.sym}${iso.s ? ' ‚óè' : ''}`;
                    isotopeContainer.appendChild(tag);
                });
            } else {
                isotopeContainer.innerHTML = '<span style="color:#666">ÊöÇÊó†Êï∞ÊçÆ</span>';
            }

            const eData = getElectronData(data.idx);
            document.getElementById('m-config-sub').innerHTML = eData.str;
            document.getElementById('m-config-shell').innerText = `ÂàÜÂ±Ç: ${eData.shells.join(' - ')}`;

            render3DAtom(data.idx);
            modal.classList.add('open');
            
            // Á¶ÅÊ≠¢ËÉåÊôØÊªöÂä®
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            modal.classList.remove('open');
            document.body.style.overflow = '';
            setTimeout(() => atomContainer.innerHTML = '', 300);
        }

        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        document.getElementById('searchInput').addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase().trim();
            
            document.querySelectorAll('.element').forEach(el => {
                let match = false;

                if (el.classList.contains('placeholder')) {
                    const textContent = el.innerText.toLowerCase();
                    match = textContent.includes(val);
                } 
                else if (el.dataset.idx) {
                    const d = elements[el.dataset.idx - 1];
                    match = d.name.includes(val) || 
                            d.sym.toLowerCase().includes(val) || 
                            String(d.idx) === val || 
                            d.enName.toLowerCase().includes(val);
                }

                if (val === '') {
                    el.style.opacity = '1';
                    el.style.filter = 'none';
                } else {
                    el.style.opacity = match ? '1' : '0.1';
                    el.style.filter = match ? 'none' : 'grayscale(100%)';
                }
            });
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        init();
    </script>
</body>
</html>